IF NOT EXISTS (SELECT TOP 1 1 FROM Pttcd.Regions WHERE Position IS NOT NULL)
BEGIN
	DECLARE @Regions TABLE (
		RegionId VARCHAR(12),
		Name NVARCHAR(100),
		ParentRegionId VARCHAR(12),
		Position GEOGRAPHY
	)

	INSERT INTO @Regions (RegionId, Name, ParentRegionId, Position) VALUES
		('E12000001', 'North East', null, geography::Point(54.770012, -1.33372, 4326)),
		('E06000001', 'County Durham', 'E06000001', geography::Point(54.77869, -1.55961, 4326)),
		('E06000002', 'Darlington', 'E06000002', geography::Point(54.52873, -1.55305, 4326)),
		('E06000003', 'Gateshead', 'E06000003', geography::Point(54.95937, -1.60182, 4326)),
		('E06000004', 'Hartlepool', 'E06000004', geography::Point(54.68249, -1.2167, 4326)),
		('E06000005', 'Middlesbrough', 'E06000005', geography::Point(54.57301, -1.23791, 4326)),
		('E06000047', 'Newcastle upon Tyne', 'E06000047', geography::Point(54.97784, -1.61292, 4326)),
		('E06000057', 'North Tyneside', 'E06000057', geography::Point(55.0182, 1.4858, 4326)),
		('E08000021', 'Northumberland', 'E08000021', geography::Point(55.2083, -2.0784, 4326)),
		('E08000022', 'Redcar and Cleveland', 'E08000022', geography::Point(54.60301, -1.07763, 4326)),
		('E08000023', 'South Tyneside', 'E08000023', geography::Point(54.9637, -1.4419, 4326)),
		('E08000024', 'Stockton-on-Tees', 'E08000024', geography::Point(54.56823, -1.31443, 4326)),
		('E08000037', 'Sunderland', 'E08000037', geography::Point(54.90445, -1.38145, 4326)),
		('E12000002', 'North West', null, geography::Point(53.789707, -2.6541, 4326)),
		('E06000006', 'Halton', 'E06000006', geography::Point(53.3613, -2.7335, 4326)),
		('E06000007', 'Warrington', 'E06000007', geography::Point(53.39266, -2.587, 4326)),
		('E06000008', 'Blackburn with Darwen', 'E06000008', geography::Point(53.7501, -2.48471, 4326)),
		('E06000009', 'Blackpool', 'E06000009', geography::Point(53.81418, -3.05354, 4326)),
		('E06000049', 'Cheshire East', 'E06000049', geography::Point(53.161, -2.2186, 4326)),
		('E06000050', 'Cheshire West and Chester', 'E06000050', geography::Point(53.21744, -2.74297, 4326)),
		('E08000001', 'Bolton', 'E08000001', geography::Point(53.57846, -2.42984, 4326)),
		('E08000002', 'Bury', 'E08000002', geography::Point(53.59346, -2.29854, 4326)),
		('E08000003', 'Manchester', 'E08000003', geography::Point(53.48071, -2.23438, 4326)),
		('E08000004', 'Oldham', 'E08000004', geography::Point(53.54125, -2.11766, 4326)),
		('E08000005', 'Rochdale', 'E08000005', geography::Point(53.61635, -2.15871, 4326)),
		('E08000006', 'Salford', 'E08000006', geography::Point(53.4875, -2.2901, 4326)),
		('E08000007', 'Stockport', 'E08000007', geography::Point(53.40849, -2.14929, 4326)),
		('E08000008', 'Tameside', 'E08000008', geography::Point(53.4806, -2.081, 4326)),
		('E08000009', 'Trafford', 'E08000009', geography::Point(53.4707, -2.3231, 4326)),
		('E08000010', 'Wigan', 'E08000010', geography::Point(53.54427, -2.63106, 4326)),
		('E08000011', 'Knowsley', 'E08000011', geography::Point(53.4546, -2.8529, 4326)),
		('E08000012', 'Liverpool', 'E08000012', geography::Point(53.41078, -2.97784, 4326)),
		('E08000013', 'St Helens', 'E08000013', geography::Point(53.45388, -2.73689, 4326)),
		('E08000014', 'Sefton', 'E08000014', geography::Point(53.5034, -2.9704, 4326)),
		('E08000015', 'Wirral', 'E08000015', geography::Point(53.3727, -3.0738, 4326)),
		('E10000006', 'Cumbria', 'E10000006', geography::Point(54.5772, -2.7975, 4326)),
		('E10000017', 'Lancashire', 'E10000017', geography::Point(53.54125, -2.11766, 4326)),
		('E12000003', 'Yorkshire and The Humber', null, geography::Point(53.676289, -0.382, 4326)),
		('E06000010', 'Kingston upon Hull', 'E06000010', geography::Point(53.74434, -0.33244, 4326)),
		('E06000011', 'East Riding of Yorkshire', 'E06000011', geography::Point(53.84292, -0.42766, 4326)),
		('E06000012', 'North East Lincolnshire', 'E06000012', geography::Point(53.5668, -0.0815, 4326)),
		('E06000013', 'North Lincolnshire', 'E06000013', geography::Point(53.6056, -0.5597, 4326)),
		('E06000014', 'York', 'E06000014', geography::Point(53.96, -1.0873, 4326)),
		('E08000016', 'Barnsley', 'E08000016', geography::Point(53.55293, -1.48127, 4326)),
		('E08000017', 'Doncaster', 'E08000017', geography::Point(53.52304, -1.13376, 4326)),
		('E08000018', 'Rotherham', 'E08000018', geography::Point(53.4302, -1.35685, 4326)),
		('E08000019', 'Sheffield', 'E08000019', geography::Point(53.38306, -1.46479, 4326)),
		('E08000032', 'Bradford', 'E08000032', geography::Point(53.79385, -1.75244, 4326)),
		('E08000033', 'Calderdale', 'E08000033', geography::Point(53.7248, -1.8658, 4326)),
		('E08000034', 'Kirklees', 'E08000034', geography::Point(53.5933, -1.801, 4326)),
		('E08000035', 'Leeds', 'E08000035', geography::Point(53.79969, -1.5491, 4326)),
		('E08000036', 'Wakefield', 'E08000036', geography::Point(53.68297, -1.4991, 4326)),
		('E10000023', 'North Yorkshire', 'E10000023', geography::Point(53.9915, -1.5412, 4326)),
		('E12000004', 'East Midlands', null, geography::Point(52.829372, -1.332134, 4326)),
		('E06000015', 'Derby', 'E06000015', geography::Point(52.9219, -1.47564, 4326)),
		('E10000007', 'Derbyshire', 'E10000007', geography::Point(52.9219, -1.47564, 4326)),
		('E06000016', 'Leicester', 'E06000016', geography::Point(52.63486, -1.12906, 4326)),
		('E10000018', 'Leicestershire', 'E10000018', geography::Point(52.63486, -1.12906, 4326)),
		('E10000019', 'Lincolnshire', 'E10000019', geography::Point(52.9452, -0.1601, 4326)),
		('E10000021', 'Northamptonshire', 'E10000021', geography::Point(52.23484, -0.89732, 4326)),
		('E06000018', 'Nottingham', 'E06000018', geography::Point(52.95512, -1.14917, 4326)),
		('E10000024', 'Nottinghamshire', 'E10000024', geography::Point(52.95512, -1.14917, 4326)),
		('E06000017', 'Rutland', 'E06000017', geography::Point(52.6583, -0.6396, 4326)),
		('E12000005', 'West Midlands', null, geography::Point(52.475075, -1.829833, 4326)),
		('E06000019', 'Herefordshire', 'E06000019', geography::Point(52.0765, -2.6544, 4326)),
		('E06000020', 'Telford and Wrekin', 'E06000020', geography::Point(52.741, -2.4869, 4326)),
		('E06000021', 'Stoke-on-Trent', 'E06000021', geography::Point(53.02578, -2.177394, 4326)),
		('E06000051', 'Shropshire', 'E06000051', geography::Point(52.67587, -2.4497, 4326)),
		('E08000025', 'Birmingham', 'E08000025', geography::Point(52.4829, -1.89346, 4326)),
		('E08000026', 'Coventry', 'E08000026', geography::Point(52.40631, -1.50852, 4326)),
		('E08000027', 'Dudley', 'E08000027', geography::Point(52.50867, -2.08734, 4326)),
		('E08000028', 'Sandwell', 'E08000028', geography::Point(52.50636, -1.96258, 4326)),
		('E08000029', 'Solihull', 'E08000029', geography::Point(52.41471, -1.7743, 4326)),
		('E08000030', 'Walsall', 'E08000030', geography::Point(52.58595, -1.98229, 4326)),
		('E08000031', 'Wolverhampton', 'E08000031', geography::Point(52.58533, -2.13192, 4326)),
		('E10000028', 'Staffordshire', 'E10000028', geography::Point(52.8793, -2.0572, 4326)),
		('E10000031', 'Warwickshire', 'E10000031', geography::Point(52.28194, -1.58447, 4326)),
		('E10000034', 'Worcestershire', 'E10000034', geography::Point(52.19204, -2.22353, 4326)),
		('E12000006', 'East of England', null, geography::Point(52.543724, -0.319955, 4326)),
		('E06000055', 'Bedford', 'E06000055', geography::Point(52.13571, -0.46804, 4326)),
		('E10000003', 'Cambridgeshire', 'E10000003', geography::Point(52.57339, -0.24846, 4326)),
		('E06000056', 'Central Bedfordshire', 'E06000056', geography::Point(52.00268, -0.29749, 4326)),
		('E10000012', 'Essex', 'E10000012', geography::Point(51.5742, -0.4857, 4326)),
		('E10000015', 'Hertfordshire', 'E10000015', geography::Point(51.8098, -0.2377, 4326)),
		('E06000032', 'Luton', 'E06000032', geography::Point(51.87965, -0.41756, 4326)),
		('E10000020', 'Norfolk', 'E10000020', geography::Point(52.614, 0.8864, 4326)),
		('E06000031', 'Peterborough', 'E06000031', geography::Point(52.57339, -0.24846, 4326)),
		('E06000033', 'Southend-on-Sea', 'E06000033', geography::Point(51.54041, 0.7077, 4326)),
		('E10000029', 'Suffolk', 'E10000029', geography::Point(52.1872, 0.9708, 4326)),
		('E06000034', 'Thurrock', 'E06000034', geography::Point(51.4935, 0.3529, 4326)),
		('E12000007', 'London', null, geography::Point(51.507351, -0.127758, 4326)),
		('E09000001', 'City of London', 'E09000001', geography::Point(51.5074, -0.1278, 4326)),
		('E09000002', 'Barking and Dagenham', 'E09000002', geography::Point(51.53628, 0.08148, 4326)),
		('E09000003', 'Barnet', 'E09000003', geography::Point(51.65293, -0.19961, 4326)),
		('E09000004', 'Bexley', 'E09000004', geography::Point(51.44135, 0.14861, 4326)),
		('E09000005', 'Brent', 'E09000005', geography::Point(51.5673, -0.2711, 4326)),
		('E09000006', 'Bromley', 'E09000006', geography::Point(51.40568, 0.01435, 4326)),
		('E09000007', 'Camden', 'E09000007', geography::Point(51.5517, -0.1588, 4326)),
		('E09000008', 'Croydon', 'E09000008', geography::Point(51.37236, -0.0982, 4326)),
		('E09000009', 'Ealing', 'E09000009', geography::Point(51.5133, -0.3043, 4326)),
		('E09000010', 'Enfield', 'E09000010', geography::Point(51.6521, -0.08153, 4326)),
		('E09000011', 'Greenwich', 'E09000011', geography::Point(51.4934, 0.0098, 4326)),
		('E09000012', 'Hackney', 'E09000012', geography::Point(51.5734, -0.0724, 4326)),
		('E09000013', 'Hammersmith and Fulham', 'E09000013', geography::Point(51.499, -0.2291, 4326)),
		('E09000014', 'Haringey', 'E09000014', geography::Point(51.5906, -0.111, 4326)),
		('E09000015', 'Harrow', 'E09000015', geography::Point(51.57881, -0.33376, 4326)),
		('E09000016', 'Havering', 'E09000016', geography::Point(51.5779, 0.2121, 4326)),
		('E09000017', 'Hillingdon', 'E09000017', geography::Point(51.53358, -0.45258, 4326)),
		('E09000018', 'Hounslow', 'E09000018', geography::Point(51.46759, -0.3618, 4326)),
		('E09000019', 'Islington', 'E09000019', geography::Point(51.5465, -0.1058, 4326)),
		('E09000020', 'Kensington and Chelsea', 'E09000020', geography::Point(51.4991, -0.1938, 4326)),
		('E09000021', 'Kingston upon Thames', 'E09000021', geography::Point(51.41232, -0.30044, 4326)),
		('E09000022', 'Lambeth', 'E09000022', geography::Point(51.4571, -0.1231, 4326)),
		('E09000023', 'Lewisham', 'E09000023', geography::Point(51.4415, -0.0117, 4326)),
		('E09000024', 'Merton', 'E09000024', geography::Point(51.4098, -0.2108, 4326)),
		('E09000025', 'Newham', 'E09000025', geography::Point(51.5255, 0.0352, 4326)),
		('E09000026', 'Redbridge', 'E09000026', geography::Point(51.5901, 0.0819, 4326)),
		('E09000027', 'Richmond upon Thames', 'E09000027', geography::Point(51.4613, -0.30044, 4326)),
		('E09000028', 'Southwark', 'E09000028', geography::Point(51.5028, -0.0877, 4326)),
		('E09000029', 'Sutton', 'E09000029', geography::Point(51.36045, -0.19178, 4326)),
		('E09000030', 'Tower Hamlets', 'E09000030', geography::Point(51.5203, -0.0293, 4326)),
		('E09000031', 'Waltham Forest', 'E09000031', geography::Point(51.5886, -0.0118, 4326)),
		('E09000032', 'Wandsworth', 'E09000032', geography::Point(51.4571, -0.1818, 4326)),
		('E09000033', 'Westminster', 'E09000033', geography::Point(51.4975, -0.1357, 4326)),
		('E12000008', 'South East', null, geography::Point(51.5074, -0.1278, 4326)),
		('E06000035', 'Medway', 'E06000035', geography::Point(51.4047, 0.5418, 4326)),
		('E06000036', 'Bracknell Forest', 'E06000036', geography::Point(51.4154, -0.7536, 4326)),
		('E06000037', 'West Berkshire', 'E06000037', geography::Point(51.4308, -1.1445, 4326)),
		('E06000038', 'Reading', 'E06000038', geography::Point(51.45504, -0.9781, 4326)),
		('E06000039', 'Slough', 'E06000039', geography::Point(51.50935, -0.59545, 4326)),
		('E06000040', 'Windsor and Maidenhead', 'E06000040', geography::Point(51.48467, -0.64786, 4326)),
		('E06000041', 'Wokingham', 'E06000041', geography::Point(51.41097, -0.83493, 4326)),
		('E06000042', 'Milton Keynes', 'E06000042', geography::Point(52.04144, -0.76056, 4326)),
		('E06000043', 'Brighton and Hove', 'E06000043', geography::Point(50.83022, -0.1372, 4326)),
		('E06000044', 'Portsmouth', 'E06000044', geography::Point(50.79891, -1.09116, 4326)),
		('E06000045', 'Southampton', 'E06000045', geography::Point(50.90497, -1.40323, 4326)),
		('E06000046', 'Isle of Wight', 'E06000046', geography::Point(50.6938, -1.3047, 4326)),
		('E10000002', 'Buckinghamshire', 'E10000002', geography::Point(51.8137, -0.8095, 4326)),
		('E10000011', 'East Sussex', 'E10000011', geography::Point(50.9086, -0.2494, 4326)),
		('E10000014', 'Hampshire', 'E10000014', geography::Point(51.0577, -1.3081, 4326)),
		('E10000016', 'Kent', 'E10000016', geography::Point(51.2787, 0.5217, 4326)),
		('E10000025', 'Oxfordshire', 'E10000025', geography::Point(51.75374, -1.26346, 4326)),
		('E10000030', 'Surrey', 'E10000030', geography::Point(51.3148, -0.56, 4326)),
		('E10000032', 'West Sussex', 'E10000032', geography::Point(50.83664, -0.4617, 4326)),
		('E12000009', 'South West', null, geography::Point(50.7772, -3.999461, 4326)),
		('E06000022', 'Bath and North East Somerset', 'E06000022', geography::Point(51.34762, -2.4766, 4326)),
		('E06000023', 'Bristol', 'E06000023', geography::Point(51.4545, -2.5879, 4326)),
		('E06000024', 'North Somerset', 'E06000024', geography::Point(51.3879, -2.7781, 4326)),
		('E06000025', 'South Gloucestershire', 'E06000025', geography::Point(51.5264, -2.4728, 4326)),
		('E06000026', 'Plymouth', 'E06000026', geography::Point(50.37038, -4.14265, 4326)),
		('E06000027', 'Torbay', 'E06000027', geography::Point(50.4619, -3.5253, 4326)),
		('E06000028', 'Bournemouth', 'E06000028', geography::Point(50.72168, -1.87853, 4326)),
		('E06000029', 'Poole', 'E06000029', geography::Point(50.71939, -1.98114, 4326)),
		('E06000030', 'Swindon', 'E06000030', geography::Point(51.55842, -1.78204, 4326)),
		('E06000052', 'Cornwall', 'E06000052', geography::Point(50.266, -5.0527, 4326)),
		('E06000053', 'Isles of Scilly', 'E06000053', geography::Point(49.9146, -6.31574, 4326)),
		('E06000054', 'Wiltshire', 'E06000054', geography::Point(51.3492, -1.9927, 4326)),
		('E10000008', 'Devon', 'E10000008', geography::Point(50.7156, -3.5309, 4326)),
		('E10000009', 'Dorset', 'E10000009', geography::Point(50.7488, -2.3445, 4326)),
		('E10000013', 'Gloucestershire', 'E10000013', geography::Point(51.86674, -2.24867, 4326)),
		('E10000027', 'Somerset', 'E10000027', geography::Point(51.1051, -2.9262, 4326))

	MERGE Pttcd.Regions AS target
	USING (SELECT * FROM @Regions) AS source
	ON source.RegionId = target.RegionId
	WHEN MATCHED THEN
		UPDATE SET
		target.Name = source.Name,
		target.ParentRegionId = source.ParentRegionId,
		target.Position = source.Position
	WHEN NOT MATCHED THEN
		INSERT (RegionId, Name, ParentRegionId, Position)
		VALUES (source.RegionId, source.Name, source.ParentRegionId, source.Position)
	WHEN NOT MATCHED BY SOURCE THEN DELETE;
END;

;WITH TLevelDefinitionsCte AS (
	SELECT * FROM (VALUES
	(
		N'fc9fefe1-ee86-4df9-9d09-c275ccbf5940',
		36,
		31,
		3,
		N'T Level Construction - Design, Surveying and Planning for Construction',
		N'This T Level is suitable for anyone wanting a career in construction, specifically in surveying and design, civil engineering, building services design, or hazardous materials surveying.' + CHAR(13) + CHAR(13) + 'The T Level is a 2 year programme and will include a 9 week (minimum) industry placement and a Technical Qualification, where you will also choose a specialist subject.',
		N'You will need either 5 GCSEs (at grade 4 or above), including English, maths and science, or a pass in a relevant level 2 qualification.' + CHAR(13) + CHAR(13) + 'If you do not have the recommended entry qualifications, you may still be considered if you have relevant experience or show a natural ability for the subject.',
		N'You''ll learn specific topics in design, surveying and planning:' + CHAR(13) + CHAR(13) + 'Project management' + CHAR(13) + 'Budgeting and resource allocation' + CHAR(13) + 'Procurement' + CHAR(13) + 'Risk management' + CHAR(13) + CHAR(13) + 'In addition to the core content, you will choose one of the following as a specialist subject:' + CHAR(13) + CHAR(13) + 'Surveying and design for construction and the built environment' + CHAR(13) + 'Civil engineering' + CHAR(13) + 'Building services design' + CHAR(13) + 'Hazardous materials analysis and surveying.',
		N'Your learning will combine classroom theory and practical learning and include 9 weeks (minimum) of industry placement. The placement will provide you with a real experience of the workplace.',
		N'You will be assessed by completing an employer set project and a project on your specialist subject. You''ll have time to research and complete tasks. There''ll also be 2 exams. ' + CHAR(13) + CHAR(13) + 'You''ll work with your tutor to decide when you''re ready to be assessed.',
		N'You''ll have the industry knowledge and experience to progress into roles like:' + CHAR(13) + CHAR(13) + 'Civil engineering technician' + CHAR(13) + 'Technical surveyor' + CHAR(13) + 'Building technician' + CHAR(13) + 'Engineering construction technician' + CHAR(13) + 'Architectural technician' + CHAR(13) + CHAR(13) + 'or go onto an apprenticeship or higher education.'
	),
	(
		N'9555d14f-f73b-495c-91c3-4703691c6347',
		37,
		31,
		3,
		N'T Level Digital - Digital Production, Design and Development',
		N'This T Level is suitable for anyone wanting a career in software production and design.' + CHAR(13) + CHAR(13) + 'The T Level is a 2 year programme and will include a 9 week (minimum) industry placement and a Technical Qualification.',
		N'You will need either 5 GCSEs (at grade 4 or above), including English, maths and science, or a pass in a relevant level 2 qualification, for example a BTEC Tech Award in Digital Information Technology.' + CHAR(13) + CHAR(13) + 'If you do not have the recommended entry qualifications, you may still be considered if you have relevant experience or show a natural ability for the subject.',
		N'You will develop the skills to:' + CHAR(13) + CHAR(13) + 'Analyse a problem, understand user needs, define requirements and set acceptance criteria' + CHAR(13) + 'Design, implement and test software' + CHAR(13) + 'Change, maintain and support software' + CHAR(13) + 'Work collaboratively in a digital team' + CHAR(13) + 'Discover, evaluate and apply reliable sources of knowledge' + CHAR(13) + 'Work within legal and regulatory frameworks when developing software.',
		N'Your learning will combine classroom theory and practical learning and include 9 weeks (minimum) of industry placement.  The placement will provide you with a real experience of the workplace.',
		N'You will be assessed by completing an employer set project and a project on a specialist subject. You''ll have time to research and complete tasks. There''ll also be 2 exams.' + CHAR(13) + CHAR(13) + 'You''ll work with your tutor to decide when you''re ready to be assessed.',
		N'You''ll have the industry knowledge and experience to progress into roles like:' + CHAR(13) + CHAR(13) + 'Web developer' + CHAR(13) + 'Web designer' + CHAR(13) + 'IT business analyst' + CHAR(13) + 'App developer' + CHAR(13) + 'Digital marketer' + CHAR(13) + CHAR(13) + 'or to go onto an apprenticeship or higher education.'
	),
	(
		N'c1bc1361-cda3-42a3-9120-a08cdb78dba0',
		38,
		31,
		3,
		N'T Level Education - Education and Childcare',
		N'This T Level is suitable for anyone wanting a career in early years education, childcare or assisting teaching.' + CHAR(13) + CHAR(13) + 'The T Level is a 2 year programme and will include a 9 week (minimum) industry placement and a Technical Qualification, where you will also choose a specialist subject.',
		N'You will need either 5 GCSEs (at grade 4 or above), including English, maths and science, or a pass in a relevant level 2 qualification.' + CHAR(13) + CHAR(13) + 'If you do not have the recommended entry qualifications, you may still be considered if you have relevant experience or show a natural ability for the subject.',
		N'You will develop an understanding of:' + CHAR(13) + CHAR(13) + 'The education and childcare sector from ages 0 to 19' + CHAR(13) + 'Child development' + CHAR(13) + 'How to support children and young people’s education' + CHAR(13) + 'Safeguarding, health and safety and wellbeing' + CHAR(13) + 'Understanding and managing behaviour' + CHAR(13) + 'Observing and assessing children and young people' + CHAR(13) + 'Equality and diversity' + CHAR(13) + 'Special educational needs and disability' + CHAR(13) + 'English as an additional language' + CHAR(13) + 'Working with parents, carers and wider families' + CHAR(13) + 'Working with agencies and services that support children, families and carers' + CHAR(13) + 'Reflective practice and other forms of professional development' + CHAR(13) + CHAR(13) + 'In addition to the core content, you will choose one of the following as a specialist subject:' + CHAR(13) + CHAR(13) + 'Early years education and childcare' + CHAR(13) + 'Assisting teaching' + CHAR(13) + 'Supporting and mentoring students in further and higher education (available from September 2021)',
		N'Your learning will combine classroom theory and practical learning and include 9 weeks (minimum) of industry placement.  The placement will provide you with real experience of the workplace.',
		N'You will be assessed by completing employer set project and a project on your specialist subject. You''ll have time to research and complete tasks. There''ll also be 2 exams.' + CHAR(13) + CHAR(13) + 'You''ll work with your tutor to decide when you''re ready to be assessed.',
		N'You''ll have the industry knowledge and experience to progress into roles like:' + CHAR(13) + CHAR(13) + 'Nursery worker' + CHAR(13) + 'Special educational needs (SEN) teaching assistant' + CHAR(13) + 'Teaching assistant' + CHAR(13) + 'Learning mentor' + CHAR(13) + CHAR(13) + 'or to go onto an apprenticeship or higher education.'
	)
) AS TLevelDefinitions(
	TLevelDefinitionId,
	FrameworkCode,
	ProgType,
	QualificationLevel,
	[Name],
	ExemplarWhoFor,
	ExemplarEntryRequirements,
	ExemplarWhatYoullLearn,
	ExemplarHowYoullLearn,
	ExemplarHowYoullBeAssessed,
	ExemplarWhatYouCanDoNext
))
MERGE Pttcd.TLevelDefinitions AS target
USING (
	SELECT *
	FROM TLevelDefinitionsCte
) AS source
ON target.TLevelDefinitionId = source.TLevelDefinitionId
WHEN MATCHED
	THEN UPDATE SET
		target.FrameworkCode = source.FrameworkCode,
		target.ProgType = source.ProgType,
		target.QualificationLevel = source.QualificationLevel,
		target.Name = source.Name,
		target.ExemplarWhoFor = source.ExemplarWhoFor,
		target.ExemplarEntryRequirements = source.ExemplarEntryRequirements,
		target.ExemplarWhatYoullLearn = source.ExemplarWhatYoullLearn,
		target.ExemplarHowYoullLearn = source.ExemplarHowYoullLearn,
		target.ExemplarHowYoullBeAssessed = source.ExemplarHowYoullBeAssessed,
		target.ExemplarWhatYouCanDoNext = source.ExemplarWhatYouCanDoNext
WHEN NOT MATCHED
	THEN INSERT (
		TLevelDefinitionId,
		FrameworkCode,
		ProgType,
		QualificationLevel,
		Name,
		ExemplarWhoFor,
		ExemplarEntryRequirements,
		ExemplarWhatYoullLearn,
		ExemplarHowYoullLearn,
		ExemplarHowYoullBeAssessed,
		ExemplarWhatYouCanDoNext
	) VALUES (
		source.TLevelDefinitionId,
		source.FrameworkCode,
		source.ProgType,
		source.QualificationLevel,
		source.Name,
		source.ExemplarWhoFor,
		source.ExemplarEntryRequirements,
		source.ExemplarWhatYoullLearn,
		source.ExemplarHowYoullLearn,
		source.ExemplarHowYoullBeAssessed,
		source.ExemplarWhatYouCanDoNext
	)
WHEN NOT MATCHED BY SOURCE
	THEN DELETE;
