@using Dfc.CourseDirectory.Models.Enums
@using Dfc.CourseDirectory.Models.Models.Courses
@using Dfc.CourseDirectory.Web.Helpers
@using System.ComponentModel.DataAnnotations
@model Dfc.CourseDirectory.Web.ViewModels.CourseSummary.CourseSummaryViewModel

@{
    var deliveryModeAttribute = Model.DeliveryMode.GetAttribute<DisplayAttribute>();
    var attendanceAttribute = Model.AttendancePattern.GetAttribute<DisplayAttribute>();
    var studyModeAttribute = Model.StudyMode.GetAttribute<DisplayAttribute>();
}
<div class=" cd-fullwidth-container govuk-!-padding-top-9">
    <div class="govuk-width-container cd-course-page">
        <a asp-controller="ProviderCourses" asp-action="Index" class="govuk-back-link">Back</a>
        <main class="govuk-main-wrapper">
            <div class="govuk-grid-row">
                <div class="govuk-grid-column-two-thirds">
                    <span class="govuk-caption-xl">@Model.QualificationCourseTitle</span>
                    <h1 class="govuk-heading-xl">@Model.CourseName</h1>
                    <table class="govuk-table">
                        <thead class="govuk-table__head">
                            <tr class="govuk-table__row">
                                <th class="govuk-table__header" scope="row">Lars/QAN:</th>
                                <td class="govuk-table__cell">@Model.LearnAimRef</td>
                            </tr>
                        </thead>
                        <tbody class="govuk-table__body">
                            <tr class="govuk-table__row">
                                <th class="govuk-table__header" scope="row">Level:</th>
                                <td class="govuk-table__cell">@Model.NotionalNVQLevelv2</td>
                            </tr>
                            <tr class="govuk-table__row">
                                <th class="govuk-table__header" scope="row">Awarding organisation:</th>
                                <td class="govuk-table__cell">@Model.AwardOrgCode</td>
                            </tr>
                        </tbody>
                    </table>


                    <h3 class="govuk-heading-m govuk-!-margin-top-0">
                        <a class="govuk-link" style="padding-right:1em"
                           asp-controller="EditCourseRun"
                           asp-action="Index"
                           asp-route-learnAimRef="@Model.LearnAimRef"
                           asp-route-notionalNVQLevelv2="@Model.NotionalNVQLevelv2"
                           asp-route-awardOrgCode="@Model.AwardOrgCode"
                           asp-route-learnAimRefTitle="@Model.QualificationCourseTitle"
                           asp-route-learnAimRefTypeDesc="@Model.QualificationType"
                           asp-route-courseId="@Model.CourseId"
                           asp-route-courseRunId="@Model.CourseInstanceId"
                           asp-route-mode="@PublishMode.Summary">Edit course information</a>
                    </h3>

                    <table class="govuk-table">
                        <thead class="govuk-table__head">

                        </thead>
                        <tbody class="govuk-table__body">
                            <tr class="govuk-table__row">
                                <th class="govuk-table__header" scope="col">Course Name:</th>
                                <td class="govuk-table__cell" scope="col">@Model.CourseName</td>
                            </tr>
                            <tr class="govuk-table__row">
                                <th class="govuk-table__header" scope="row">ID:</th>
                                <td class="govuk-table__cell">@Model.ProviderCourseID</td>
                            </tr>
                            <tr class="govuk-table__row">
                                <th class="govuk-table__header" scope="row">Delivery:</th>
                                <td class="govuk-table__cell">@deliveryModeAttribute.Name</td>
                            </tr>
                            <tr class="govuk-table__row">
                                <th class="govuk-table__header" scope="row">Start date:</th>
                                @{
                                    if (Model.FlexibleStartDate == true)
                                    {
                                        <td class="govuk-table__cell">Flexible start date</td>
                                    }
                                    else
                                    {
                                        <td class="govuk-table__cell">@Model.StartDate.Value.ToString("dd/MM/yyyy")</td>
                                    }
                                }
                            </tr>
                            @{
                                if (Model.DeliveryMode == DeliveryMode.WorkBased)
                                {
                                    <tr class="govuk-table__row">
                                        <th class="govuk-table__header" scope="col" style="vertical-align: text-top;">Region(s):</th>
                                        @{
                                            <td class="govuk-table__cell">
                                                @foreach (var region in Model.Regions)
                                                {
                                                    @region
                                                    <br />
                                                }
                                            </td>
                                        }

                                    </tr>
                                }
                            }
                            @{
                                if (Model.DeliveryMode == DeliveryMode.ClassroomBased)
                                {
                                    <tr class="govuk-table__row">
                                        <th class="govuk-table__header" scope="col">Venue:</th>
                                        <td class="govuk-table__cell" scope="col">@Model.VenueName</td>
                                    </tr>
                                }
                            }
                            <tr class="govuk-table__row">
                                <th class="govuk-table__header" scope="row">Url:</th>
                                <td class="govuk-table__cell"><a href="@Model.CourseURL" target="_blank" style="word-break: break-all">@Model.CourseURL</a></td>
                            </tr>
                            <tr class="govuk-table__row">
                                <th class="govuk-table__header" scope="row">Cost:</th>
                                <td class="govuk-table__cell">£@Model.Cost</td>
                            </tr>
                            <tr class="govuk-table__row">
                                <th class="govuk-table__header" scope="row">Cost description:</th>
                                <td class="govuk-table__cell">
                                    <details class="govuk-details" role="group">
                                        <summary class="govuk-details__summary" role="button" aria-controls="details-content-4386f8be-5919-4bb4-89d7-41219af78831" aria-expanded="false">
                                            <span class="govuk-details__summary-text">
                                                View
                                            </span>
                                        </summary>
                                        <div class="govuk-details__text" id="details-content-4386f8be-5919-4bb4-89d7-41219af78831" aria-hidden="true">
                                            @Model.CostDescription
                                        </div>
                                    </details>
                                </td>
                            </tr>
                            <tr class="govuk-table__row">
                                <th class="govuk-table__header" scope="row">Duration:</th>
                                <td class="govuk-table__cell">@Model.DurationValue @Model.DurationUnit</td>
                            </tr>
                            @{
                                if (Model.DeliveryMode == DeliveryMode.ClassroomBased)
                                {
                                    <tr class="govuk-table__row">
                                        <th class="govuk-table__header" scope="row">Full time or part time:</th>
                                        <td class="govuk-table__cell">@studyModeAttribute.Name</td>
                                    </tr>
                                    <tr class="govuk-table__row">
                                        <th class="govuk-table__header" scope="row">Attendance:</th>
                                        <td class="govuk-table__cell">@attendanceAttribute.Name</td>
                                    </tr>
                                }
                            }

                        </tbody>
                    </table>


                    <h3 class="govuk-heading-m govuk-!-margin-top-0">
                        What your learners need to know
                    </h3>
                    <table class="govuk-table">
                        <tbody>
                            <tr class="govuk-table__row">
                                <th class="govuk-table__header" scope="row">Who is this course for </th>
                                <td class="govuk-table__cell">
                                    <details class="govuk-details" role="group">
                                        <summary class="govuk-details__summary" role="button" aria-controls="details-content-78ad1d3d-97e3-4aab-844f-fc7d331d17be" aria-expanded="false">
                                            <span class="govuk-details__summary-text">
                                                View
                                            </span>
                                        </summary>
                                        <div class="govuk-details__text" id="details-content-78ad1d3d-97e3-4aab-844f-fc7d331d17be" aria-hidden="true">
                                            @Model.CourseDescription
                                        </div>
                                    </details>
                                </td>
                            </tr>

                            <tr class="govuk-table__row">
                                <th class="govuk-table__header" scope="row">Entry requirements </th>
                                <td class="govuk-table__cell">
                                    <details class="govuk-details" role="group">
                                        <summary class="govuk-details__summary" role="button" aria-controls="details-content-4aa86daa-5204-432a-9fe6-338b1a7219f9" aria-expanded="false">
                                            <span class="govuk-details__summary-text">
                                                View
                                            </span>
                                        </summary>
                                        <div class="govuk-details__text" id="details-content-4aa86daa-5204-432a-9fe6-338b1a7219f9" aria-hidden="true">
                                            @Model.EntryRequirements
                                        </div>
                                    </details>
                                </td>
                            </tr>

                            <tr class="govuk-table__row">
                                <th class="govuk-table__header" scope="row">What you’ll learn </th>
                                <td class="govuk-table__cell">
                                    <details class="govuk-details" role="group">
                                        <summary class="govuk-details__summary" role="button" aria-controls="details-content-88c1b9d8-0154-4e23-bde2-ef56a0e2081c" aria-expanded="false">
                                            <span class="govuk-details__summary-text">
                                                View
                                            </span>
                                        </summary>
                                        <div class="govuk-details__text" id="details-content-88c1b9d8-0154-4e23-bde2-ef56a0e2081c" aria-hidden="true">
                                            @Model.WhatYoullLearn
                                        </div>
                                    </details>
                                </td>
                            </tr>

                            <tr class="govuk-table__row">
                                <th class="govuk-table__header" scope="row">How you’ll learn</th>
                                <td class="govuk-table__cell">
                                    <details class="govuk-details" role="group">
                                        <summary class="govuk-details__summary" role="button" aria-controls="details-content-46d25118-62ca-4030-8b35-d357230fb6ce" aria-expanded="false">
                                            <span class="govuk-details__summary-text">
                                                View
                                            </span>
                                        </summary>
                                        <div class="govuk-details__text" id="details-content-46d25118-62ca-4030-8b35-d357230fb6ce" aria-hidden="true">
                                            @Model.HowYoullLearn
                                        </div>
                                    </details>
                                </td>
                            </tr>


                            <tr class="govuk-table__row">
                                <th class="govuk-table__header" scope="row">What you’ll need to bring </th>
                                <td class="govuk-table__cell">
                                    <details class="govuk-details" role="group">
                                        <summary class="govuk-details__summary" role="button" aria-controls="details-content-d795fa03-609e-466e-86bb-8cbf07563317" aria-expanded="false">
                                            <span class="govuk-details__summary-text">
                                                View
                                            </span>
                                        </summary>
                                        <div class="govuk-details__text" id="details-content-d795fa03-609e-466e-86bb-8cbf07563317" aria-hidden="true">
                                            @Model.WhatYoullNeed
                                        </div>
                                    </details>
                                </td>
                            </tr>

                            <tr class="govuk-table__row">
                                <th class="govuk-table__header" scope="row">How you'll be assessed</th>
                                <td class="govuk-table__cell">
                                    <details class="govuk-details" role="group">
                                        <summary class="govuk-details__summary" role="button" aria-controls="details-content-9ce35a38-e076-49c6-a756-65e3e5a2fc41" aria-expanded="false">
                                            <span class="govuk-details__summary-text">
                                                View
                                            </span>
                                        </summary>
                                        <div class="govuk-details__text" id="details-content-9ce35a38-e076-49c6-a756-65e3e5a2fc41" aria-hidden="true">
                                            @Model.HowYoullBeAssessed
                                        </div>
                                    </details>
                                </td>
                            </tr>

                            <tr class="govuk-table__row">
                                <th class="govuk-table__header" scope="row">Where next</th>
                                <td class="govuk-table__cell">
                                    <details class="govuk-details" role="group">
                                        <summary class="govuk-details__summary" role="button" aria-controls="details-content-70078d78-3005-4f4d-9e7c-6e6f7814c802" aria-expanded="false">
                                            <span class="govuk-details__summary-text">
                                                View
                                            </span>
                                        </summary>
                                        <div class="govuk-details__text" id="details-content-70078d78-3005-4f4d-9e7c-6e6f7814c802" aria-hidden="true">
                                            @Model.WhereNext
                                        </div>
                                    </details>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="govuk-grid-column-one-third govuk-related-items">
                    <h3 class="govuk-heading-m">Status</h3>
                    <span class="govuk-tag phase-tag-published govuk-!-margin-bottom-4">Published</span>
                    <hr>
                    @{
                        if (Model.UpdatedDate.HasValue)
                        {
                            <p>Last published: <br>@Model.UpdatedDate.Value.ToString("dd MMMM yyyy")</p>
                        }
                        else
                        {
                            <p>Created: <br>@Model.CreatedDate.ToString("dd MMMM yyyy")</p>
                        }
                    }

                    <hr>

                    <h3 class="govuk-heading-m m20">Copy</h3>
                    <p>
                        If you run another course that
                        offers this qualification, you
                        can copy this course,
                        edit the details and save it
                        as a new course.
                    </p>
                    <a class="govuk-link" style="padding-right:1em"
                       asp-controller="CopyCourseRun"
                       asp-action="Index"
                       asp-route-learnAimRef="@Model.LearnAimRef"
                       asp-route-notionalNVQLevelv2="@Model.NotionalNVQLevelv2"
                       asp-route-awardOrgCode="@Model.AwardOrgCode"
                       asp-route-learnAimRefTitle="@Model.QualificationCourseTitle"
                       asp-route-learnAimRefTypeDesc="@Model.QualificationType"
                       asp-route-courseId="@Model.CourseId"
                       asp-route-courseRunId="@Model.CourseInstanceId"
                       asp-route-publishMode="@PublishMode.Summary">Copy this course</a>
                    <hr>

                    <h3 class="govuk-heading-m m20">Delete</h3>
                    <p>
                        If you no longer run this course,
                        remove it from the course
                        directory
                    </p>
                    <a href="#" class="govuk-link archive" id="archive-@Model.CourseInstanceId" data-course-run-id="@Model.CourseInstanceId" style="padding-right:1em">Delete This Course</a>

                    <a id="course-confirm-archive-@Model.CourseInstanceId" class="govuk-button" asp-controller="Courses" asp-action="Archive"
                       asp-route-courseId="@Model.CourseId"
                       asp-route-courseRunId="@Model.CourseInstanceId"
                       asp-route-level="@Model.NotionalNVQLevelv2"
                       asp-route-qualificationType="@Model.QualificationType"
                       asp-route-courseName="@Model.CourseName"
                       style="display: none;padding-right:1em">Confirm delete</a>

                    <a href="#" class="govuk-link cancel-archive" id="course-cancel-archive-@Model.CourseInstanceId" data-course-run-id="@Model.CourseInstanceId" hidden="hidden">Cancel</a>
                </div>
            </div>

        </main>
    </div>
</div>
<script>
    (function ($) {
        $(function () {
            var $archiveButton = $(".archive");

            var $cancelArchiveButton = $(".cancel-archive");

            $cancelArchiveButton.on("click",
                function (event) {
                    event.preventDefault();
                    {
                        var courseRunId = $(this).attr("data-course-run-id");

                        var archiveOption = $("#archive-" + courseRunId);
                        archiveOption.show();

                        var confirmArchive = $("#course-confirm-archive-" + courseRunId);
                        confirmArchive.hide();

                        var archiveCancelDelete = $("#course-cancel-archive-" + courseRunId);
                        archiveCancelDelete.hide();

                    }
                });


            $archiveButton.on("click",
                function (event) {
                    event.preventDefault();

                    $('.govuk-button').hide();

                    $('.cancel-archive').hide();

                    $('.archive').show();

                    var courseRunId = $(this).attr("data-course-run-id");

                    var archiveOption = $("#archive-" + courseRunId);
                    archiveOption.hide();

                    var confirmArchive = $("#course-confirm-archive-" + courseRunId);
                    confirmArchive.show();

                    var archiveCancelDelete = $("#course-cancel-archive-" + courseRunId);
                    archiveCancelDelete.show().css("display", "block");

                });

        });
    })(jQuery);
</script>