@model Dfc.CourseDirectory.Web.ViewComponents.CourseProviderReference.CourseProviderReferenceModel

@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

<div class="govuk-form-group">
    <label class="govuk-label" asp-for="@Model.CourseProviderReference">
        @Model.LabelText
    </label>
    @if (!string.IsNullOrWhiteSpace(Model.HintText))
    {
        <span class="govuk-hint">
            @Model.HintText
        </span>
    }
    <span asp-validation-for="@Model.CourseProviderReference" class="govuk-error-message"></span>
    <input class="govuk-input" asp-for="@Model.CourseProviderReference" type="text" aria-describedby="@Model.AriaDescribedBy">
</div>

<script>
    (function ($) {
        $(function () {
            var formGroupErrorClass = "govuk-form-group--error";
            var elementErrorClass = "govuk-input--error";
            var $elementCourseProviderReference = $("#@nameof(Model.CourseProviderReference)");
            var $validationMessageCourseProviderReference = $elementCourseProviderReference.prev("[data-valmsg-for='@nameof(Model.CourseProviderReference)']");
            $validationMessageCourseProviderReference.css("margin-bottom", "0");
            var $formGroupCourseProviderReference = $elementCourseProviderReference.closest('.govuk-form-group');

            var $form = $elementCourseProviderReference.closest("form");
            $form.addTriggersToJqueryValidate().triggerElementValidationsOnFormValidation();
            var validator = $form.validate();

            $elementCourseProviderReference.on("blur", function () {
                var trimmed = $elementCourseProviderReference.val().trim();
                $elementCourseProviderReference.val(trimmed);

                var result = validator.element($elementCourseProviderReference);

                if (result) {
                    $elementCourseProviderReference.removeClass(elementErrorClass);
                    $formGroupCourseProviderReference.removeClass(formGroupErrorClass);
                    $validationMessageCourseProviderReference.hide();
                    $validationMessageCourseProviderReference.css("margin-bottom", "0");
                } else {
                    $elementCourseProviderReference.addClass(elementErrorClass);
                    $formGroupCourseProviderReference.addClass(formGroupErrorClass);
                    $validationMessageCourseProviderReference.show();
                    $validationMessageCourseProviderReference.css("margin-bottom", "15px");
                }
            });

            $elementCourseProviderReference.elementValidation(function (element, result) {
                if (!$formGroupCourseProviderReference.hasClass(formGroupErrorClass)) {
                    $validationMessageCourseProviderReference.hide();
                }

                if (result) {
                    $elementCourseProviderReference.removeClass(elementErrorClass);
                    $formGroupCourseProviderReference.removeClass(formGroupErrorClass);
                    $validationMessageCourseProviderReference.css("margin-bottom", "0");
                }
            });
        });
    })(jQuery);
</script>